{"version":3,"file":"app.46695deb0a049d9c5c56.js","mappings":"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","sources":["webpack://chess/./src/app/service/index.js","webpack://chess/./src/base/Component/index.js","webpack://chess/./src/common/Header/index.js","webpack://chess/./src/common/Button/index.js","webpack://chess/./src/common/Input/index.js","webpack://chess/./src/common/Input/style.module.css?18cc","webpack://chess/./src/app/router/index.js","webpack://chess/./src/modules/Menu/index.js","webpack://chess/./src/modules/Menu/style.module.css?3c5c","webpack://chess/./src/index.js","webpack://chess/./src/pages/home.js","webpack://chess/./src/pages/alice.js","webpack://chess/./src/pages/bob.js","webpack://chess/./src/pages/connect.js","webpack://chess/./src/pages/game.js"],"sourcesContent":["const PUBLIC_SW_PATH = './sw.js';\n\nexport const makeServiceWorkers = async () => {\n  if (navigator.serviceWorker) {\n    try {\n      const response = await navigator.serviceWorker.register(PUBLIC_SW_PATH);\n      console.log('SW register success', response);\n    } catch (error) {\n      console.error('SW register failed:', error);\n    }\n  }\n};\n","export default class {\n  constructor(tagName, attributes = {}) {\n    this._element = document.createElement(tagName);\n    for (const [key, value] of Object.entries(attributes)) {\n      this._element.setAttribute(key, value);\n    }\n  }\n\n  get element() {\n    return this._element;\n  }\n\n  subscribe(store, callback) {\n    store.subscribe(callback);\n    callback();\n  }\n}\n","import { Component } from '@/base';\nimport './style.scss';\n\nexport default class extends Component {\n  constructor(text) {\n    super('div');\n    this._element.innerText = text;\n    this._element.classList.add('header');\n  }\n\n  updateText(text) {\n    this._element.innerText = text;\n  }\n}\n","import './style.css';\nimport { Component } from '@/base';\n\nexport default class extends Component {\n  constructor(text, onClick) {\n    super('button');\n    this._element.innerText = text;\n    this._element.classList.add('button');\n    this._element.onclick = onClick;\n  }\n}\n","import { Component } from '@/base';\nimport style from './style.module.css';\n\nexport default class extends Component {\n  constructor() {\n    super('input');\n    this._element.classList.add(style.input);\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"input\":\"X6UxfUUG\"};","class Router {\n  constructor(pageId = 'page', isHashRouter = true) {\n    !isHashRouter && console.log('url routing is not available now');\n    this.pageId = pageId;\n\n    window.addEventListener('hashchange', (event) => {\n      this._resolve();\n    });\n\n    window.addEventListener('DOMContentLoaded', () => {\n      this._resolve();\n    });\n  }\n\n  initRoutes(routes) {\n    this._routes = routes;\n  }\n\n  initPageContainer(element) {\n    this._pageContainer = element;\n    this._pageContainer.id = 'page-container';\n  }\n\n  _activeClassResolver(eventType, callback) {\n    window.addEventListener(eventType, () => {\n      if (location.hash === '') {\n        callback('#');\n      } else {\n        callback(location.hash);\n      }\n    });\n  }\n\n  updateActiveClass(callback) {\n    this._activeClassResolver('hashchange', callback);\n    this._activeClassResolver('DOMContentLoaded', callback);\n  }\n\n  navigate(url) {\n    location.hash = url;\n  }\n\n  isActive(url) {\n    if (!location.hash && url === '#') {\n      return true;\n    }\n    if (location.hash === url) {\n      return true;\n    }\n    return false;\n  }\n\n  _updatePage(element) {\n    this._pageContainer.innerHTML = '';\n    this._pageContainer.appendChild(element);\n  }\n\n  _resolve() {\n    if (location.hash === '') {\n      const getHomePage = this._routes['/'];\n      if (getHomePage) {\n        this._updatePage(getHomePage());\n      }\n      return;\n    }\n\n    const getNewPage = this._routes[location.hash.replace('#', '/')];\n    if (getNewPage) {\n      this._updatePage(getNewPage());\n    } else {\n      this._pageContainer.innerHTML = '404 | Not Found';\n    }\n  }\n}\n\nexport default new Router();\n","import { Component } from '@/base';\nimport { Header } from '@/common';\nimport style from './style.module.css';\n\nexport default (headerText, buttons = []) => {\n  const element = new Component('div').element;\n  element.classList.add(style.menu);\n\n  const header = new Header(headerText);\n\n  element.appendChild(header.element);\n  buttons.forEach((button) => element.appendChild(button));\n\n  return element;\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"menu\":\"j2362cLf\"};","import './app/styles/normalize.css';\nimport { makeServiceWorkers } from './app/service';\nimport {\n  getAlicePage,\n  getBobPage,\n  getConnectPage,\n  getGamePage,\n  getHomePage,\n} from './pages';\nimport router from './app/router';\n\nwindow.addEventListener('load', () => {\n  makeServiceWorkers();\n});\n\nconst rootElement = document.getElementById('root');\n\nrouter.initPageContainer(rootElement);\nrouter.initRoutes({\n  '/': getHomePage,\n  '/alice': getAlicePage,\n  '/bob': getBobPage,\n  '/connect': getConnectPage,\n  '/game': getGamePage,\n});\n","import router from '../app/router';\nimport { getMenuModule } from '../modules';\nimport { Button } from '@/common';\n\nexport default () => {\n  const page = document.createElement('div');\n\n  const connectButton = new Button('p2p', () => {\n    router.navigate('connect');\n  }).element;\n  const offlineButton = new Button('offline').element;\n  offlineButton.disabled = true;\n\n  const menuButtons = [connectButton, offlineButton];\n\n  page.appendChild(getMenuModule('Menu', menuButtons));\n\n  return page;\n};\n","import { Button } from '@/common';\nimport router from '../app/router';\n\nconst setLocalDescription = async (peerConnection, offer) => {\n  peerConnection.onicecandidate = () => console.log('получен icecandidate');\n  peerConnection.setRemoteDescription(JSON.parse(offer));\n\n  window.dataChannel;\n  peerConnection.ondatachannel = (event) => {\n    window.dataChannel = event.channel;\n    window.dataChannel.onopen = () => {\n      console.log('Канал получен и открыт!');\n      router.navigate('game');\n    };\n  };\n\n  const answer = await peerConnection.createAnswer();\n  peerConnection.setLocalDescription(answer);\n};\n\nexport default () => {\n  const page = document.createElement('div');\n  const peerConnection = new RTCPeerConnection();\n\n  const pasteButton = new Button('Paste', () => {\n    navigator.clipboard\n      .readText()\n      .then((text) => {\n        console.log('paste');\n        setLocalDescription(peerConnection, text);\n      })\n      .catch(console.error);\n  }).element;\n\n  const copyOffer = new Button('Copy', () => {\n    const offer = JSON.stringify(peerConnection.localDescription);\n    if (offer) {\n      navigator.clipboard\n        .writeText(offer)\n        .then(() => {\n          console.log('copied');\n        })\n        .catch(console.error);\n    }\n  }).element;\n\n  page.appendChild(pasteButton);\n  page.appendChild(copyOffer);\n\n  return page;\n};\n","import { Button } from '@/common';\nimport router from '../app/router';\n\nconst setLocalDescription = async (peerConnection) => {\n  window.dataChannel = peerConnection.createDataChannel('channel-name');\n\n  window.dataChannel.onopen = () => {\n    console.log('Канал открыт');\n    router.navigate('game');\n  };\n\n  const offer = await peerConnection.createOffer();\n\n  peerConnection.setLocalDescription(offer);\n\n  peerConnection.onicecandidate = (e) => {\n    console.log('получен icecandidate');\n  };\n};\n\nconst setRemoteDescription = (peerConnection, answer) => {\n  peerConnection.setRemoteDescription(JSON.parse(answer));\n};\n\nexport default () => {\n  const page = document.createElement('div');\n  const peerConnection = new RTCPeerConnection();\n\n  setLocalDescription(peerConnection);\n\n  const copyOffer = new Button('Copy', () => {\n    const offer = JSON.stringify(peerConnection.localDescription);\n    if (offer) {\n      navigator.clipboard\n        .writeText(offer)\n        .then(() => {\n          console.log('copied');\n        })\n        .catch(console.error);\n    }\n  }).element;\n\n  const pasteButton = new Button('Paste', () => {\n    navigator.clipboard\n      .readText()\n      .then((text) => {\n        console.log('paste');\n        setRemoteDescription(peerConnection, text);\n      })\n      .catch(console.error);\n  }).element;\n\n  page.appendChild(copyOffer);\n  page.appendChild(pasteButton);\n\n  return page;\n};\n","import router from '../app/router';\nimport { getMenuModule } from '../modules';\nimport { Button } from '@/common';\n\nexport default () => {\n  const page = document.createElement('div');\n\n  const bobButton = new Button('Bob', () => {\n    router.navigate('bob');\n  }).element;\n\n  const aliceButton = new Button('Alice', () => {\n    router.navigate('alice');\n  }).element;\n\n  const backButton = new Button('Go back', () => {\n    router.navigate('');\n  }).element;\n\n  const menuButtons = [bobButton, aliceButton, backButton];\n\n  page.appendChild(getMenuModule('Choose the role', menuButtons));\n\n  return page;\n};\n","import { Button, Input } from '../common';\n\nexport default () => {\n  const page = document.createElement('div');\n  const form = document.createElement('form');\n  form.onsubmit = (event) => event.preventDefault();\n\n  const chatContainer = document.createElement('div');\n  if (window.dataChannel) {\n    window.dataChannel.onmessage = (event) => {\n      const message = document.createElement('div');\n      message.innerText = `[${new Date().toUTCString()}]: ${event.data}`;\n      message.style.color = 'grey';\n      chatContainer.appendChild(message);\n    };\n  }\n  const input = new Input().element;\n  const sendButton = new Button('Send', () => {\n    if (input.value) {\n      const message = document.createElement('div');\n      message.innerText = `[${new Date().toUTCString()}]: ${input.value}`;\n      chatContainer.appendChild(message);\n\n      if (window.dataChannel) {\n        dataChannel.send(input.value);\n      }\n      input.value = '';\n    }\n  }).element;\n\n  form.appendChild(input);\n  form.appendChild(sendButton);\n  page.appendChild(form);\n  page.appendChild(chatContainer);\n  return page;\n};\n"],"names":["constructor","tagName","attributes","arguments","length","undefined","this","_element","document","createElement","key","value","Object","entries","setAttribute","element","subscribe","store","callback","Component","text","super","innerText","classList","add","updateText","onClick","onclick","pageId","console","log","window","addEventListener","event","_resolve","initRoutes","routes","_routes","initPageContainer","_pageContainer","id","_activeClassResolver","eventType","location","hash","updateActiveClass","navigate","url","isActive","_updatePage","innerHTML","appendChild","getHomePage","getNewPage","replace","headerText","buttons","header","Header","forEach","button","async","navigator","serviceWorker","response","register","error","makeServiceWorkers","rootElement","getElementById","router","page","connectButton","Button","offlineButton","disabled","menuButtons","getMenuModule","peerConnection","RTCPeerConnection","pasteButton","clipboard","readText","then","offer","onicecandidate","setRemoteDescription","JSON","parse","dataChannel","ondatachannel","channel","onopen","answer","createAnswer","setLocalDescription","catch","copyOffer","stringify","localDescription","writeText","createDataChannel","createOffer","e","form","onsubmit","preventDefault","chatContainer","onmessage","message","Date","toUTCString","data","style","color","input","Input","sendButton","send"],"sourceRoot":""}